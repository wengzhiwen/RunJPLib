# Admin 面板功能指南
## 招生信息一览：基于标签的筛选

在“招生信息一览”页面顶部新增了标签筛选区：

- 展示系统中所有存在的 `tags`，按包含的招生信息数量从多到少排列。
- 支持选择 1-2 个标签。
  - 选择 1 个：筛选包含该标签的最新招生信息（按大学名去重）。
  - 选择 2 个：筛选同时包含两个标签的最新招生信息（AND/交集）。
- 筛选后仍保持：
  - 去重：同一所大学（`university_name` 相同）仅展示最新的一份（按 `_id` 倒序取第一条）。
  - 排序：按创建时间（`_id` 等价于创建时间）逆序显示。

相关API：

- `GET /admin/api/university-tags`
  - 返回示例：`[{"tag": "国立", "count": 120}, {"tag": "難関", "count": 78}]`
- `GET /admin/api/universities?tags=国立,理系`
  - 最多支持两个标签，逗号分隔；若只传一个则为单标签筛选。
# 后台管理面板

RunJPLib 的后台管理面板是一个功能强大的内部工具，旨在为管理员提供一个集中化的界面来管理网站内容、处理数据和监控系统状态。

## 访问与安全

- **访问地址**: `/admin`
- **认证**: 访问受到严格保护。管理员必须在登录页面输入通过环境变量 `ACCESS_CODE` 配置的访问码。成功登录后，系统会使用安全的 `HttpOnly` Cookie 来维持会话，用于验证后续的所有页面和 API 请求。

## 主要功能模块

### 1. 仪表盘 (`/admin`)
后台的欢迎页面，提供系统核心指标的快照。

- **数据一览**: 实时显示收录的学校总数、博客文章总数、24小时独立访客数以及各主要页面的浏览量。
- **系统状态监控**: 实时展示三个核心后台线程池（用户访问日志、博客 HTML 构建、Admin 操作）的运行状态，包括活跃线程数、队列大小和负载情况，便于管理员实时了解系统健康状况。

### 2. 招生信息管理
- **招生信息一览 (`/admin/manage/universities`)**: 以表格形式展示所有大学的招生信息，包括大学的日文名、中文名、Premium 状态和报名截止日期。管理员可在此进行编辑或删除操作。删除操作会同时移除数据库记录和关联的向量索引，确保数据一致性。
- **招生信息生成 (`/admin/pdf/processor`)**: 上传大学的 PDF 招生简章，启动自动化的信息处理流程。
- **任务列表 (`/admin/pdf/tasks`)**: 查看所有 PDF 处理任务的进度、状态和日志。

### 3. 博客管理
- **Blog 一览 (`/admin/manage/blogs`)**: 管理所有博客文章。管理员可在此页面进行编辑、删除操作，或通过“新建博客”按钮进入 AI 博客生成器。
- **异步生成**: AI 博客生成是一个后台异步任务，管理员提交生成请求后可立即离开页面，无需等待。
- **可见性控制**: 在编辑页面，可以轻松切换博客的“公开”或“私密”状态，以控制其是否对公众可见。
- **快速再生成**: 对于由 AI 生成的文章，编辑页面提供“再生成”按钮，可一键使用原始参数快速创建新版本。

### 4. 分析与洞察
- **独立 IP (24h) (`/admin/analytics/unique_ips`)**: 查看过去24小时内访问过网站的独立 IP 列表，并利用集成的 GeoIP 功能显示每个 IP 的地理位置信息（国家、城市），帮助了解用户分布。

### 5. AI 对话测试
- **AI 对话 (`/admin/chat`)**: 一个供管理员测试和调试 AI 对话功能的界面。管理员可以选择任意一所大学，直接与该大学的招生信息进行对话，以验证混合搜索和 AI 回答的准确性。
