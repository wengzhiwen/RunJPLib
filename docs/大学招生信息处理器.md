# 大学招生信息处理器

这是一个Admin后台的功能，用户上传一个pdf，启动异步处理器，待后端完成全部处理后，自动将处理结果保存到MongoDB中。

这里一个独立的Admin后台的功能。

## 生成的方式

 - 提供一个PDF文件的上传入口
 - 用户点击开始处理，即会看到在下方的任务列表中有一个新的任务被创建
 - 用户可以点进任务看到任务处理的进度（主要是进行的步骤、处理日志等）
 - 处理结束后任务列表中的任务不会立即消失，最近7天的任务（不论成功与否）都会在任务列表显示
 - 暂不提供中断任务的功能

PDF的处理是完全异步的，意味着只要系统认为处理成功，无需用户确认，处理结果就会被登录到MongoDB并对外发布。

## 从已有的参考代码中移行

ref文件夹中原本是一个独立的项目，专门为本项目（RunJPLib）生成数据。

请从 ref/process_handbooks_pdf.py 着手学习已有的，已经非常成熟的代码：

 - 整个处理过程是被一个叫做 buffalo 的流程生命周期管理器管理的
    - ref/wf_template.yml 是pdf处理器的整个处理流程的定义（buffalo的工作蓝图）
 - 可以明确的看到一共分为5个步骤
    - 01_pdf2img
    - 02_ocr
    - 03_translate
    - 04_analysis
    - 05_output
 - 前4个步骤分别由对应的pyton代码也来负责完成：
    - 步骤一直接由 ref/process_handbooks_pdf.py 处理
    - 步骤二由 ref/ocr_tool.py 处理
    - 步骤三由 ref/translate_tool.py 处理
    - 步骤四由 ref/analysis_tool.py 处理
 - 第5个步骤需要在本次移行中修改为上传到MongoDB进行发布

这次的目标是参考既有的代码，对RunJPLib的Admin后台进行开发。

开发完成后，原有的项目会被废弃，转而只使用RunJPLib的Admin后台。

注意：ref文件夹只是一个参考用的文件夹，最后会被删除，不要直接从正式代码中直接链接到ref文件夹中。

但考虑到上述代码已经非常成熟稳定，你可以从中直接大幅复制到当前项目中。

## 关于AI的使用

相应的，env文件中也需要补充与AI相关的设定，你可能无法直接访问 .env 文件。请将所有的设定项目写到到文档中，我会根据文档补充env文件。

## 其他注意事项

 - 日志系统应该根据RunJPLib的使用习惯来整合，并为了能让用户通过任务列表来查看而优化（比如任务详情页面对日志进行流式传输），而不是照搬
 - ref文件夹中还有很多与大学招生信息相关的处理代码，不在本次的需求范围之内，可以进行参考，但不要扩大我的需求

 # 重要提示

 - 正确使用已经存在的虚拟环境，不要随意创建或删除虚拟环境
 - 用户会自己启动和管理应用服务，不要企图启动或重启flask服务
 - 总是应该先阅读 docs 目录下的文档
 - 每次修改完成后，应该更新 docs 目录下的文档，包括 docs/CHANGELOG.md
 - 如果需要更多的python依赖，应该先修改 requirements.txt 再执行 pip install -r requirements.txt